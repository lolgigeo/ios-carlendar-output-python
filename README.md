# macOS 日历导出工具

这是一个用于一键导出 macOS 系统日历中所有日程记录的 Python 脚本。该工具可以将日历事件导出为 CSV 格式，支持按照时间范围筛选和指定特定日历导出。

## 功能特点

- 导出 macOS 系统日历中的所有日程记录
- 支持按照开始日期和结束日期筛选导出
- 支持指定特定日历导出
- 导出的信息包括：日历名称、日程名称、开始时间、结束时间、日程描述、地点
- 生成的 CSV 文件使用 UTF-8 编码，可在 Excel 等软件中正常显示中文

## 使用方法

### 前提条件

- 运行在 macOS 系统上
- 已安装 Python 3
- 拥有访问系统日历的权限

### 基本使用

在终端中导航到脚本所在目录，然后直接运行：

```bash
python3 calendar_export.py
```

这将导出所有日历中的所有日程事件，并生成一个包含当前日期时间的CSV文件。

### 指定时间范围

```bash
python3 calendar_export.py --start 2023-01-01 --end 2023-12-31
```

这将导出 2023 年全年的所有日程事件。

### 指定单个日历

```bash
python3 calendar_export.py --calendar "工作"
```

这将只导出名为"工作"的日历中的所有日程事件。

### 自定义输出文件名

```bash
python3 calendar_export.py --output "我的日程.csv"
```

这将使用指定的文件名保存导出的日程事件。

### 组合使用参数

```bash
python3 calendar_export.py --calendar "个人" --start 2023-01-01 --end 2023-12-31 --output "2023年个人日程.csv"
```

### 一键导出当年度日历

使用提供的专用脚本一键导出当前年度的所有日历：

1. 直接双击 **"导出当年度日历.command"** 文件
2. 按照提示选择是否导出特定日历
3. 输入文件名或使用默认文件名

### 一键导出去年度日历

使用提供的专用脚本一键导出去年的所有日历：

1. 直接双击 **"导出去年度日历.command"** 文件
2. 按照提示选择是否导出特定日历
3. 输入文件名或使用默认文件名

## 参数说明

| 参数 | 说明 | 格式 | 是否必需 |
|------|------|------|----------|
| --calendar | 指定要导出的日历名称 | 字符串，如 "工作" | 否 |
| --start | 开始日期 | YYYY-MM-DD，如 "2023-01-01" | 否 |
| --end | 结束日期 | YYYY-MM-DD，如 "2023-12-31" | 否 |
| --output | 输出的 CSV 文件名 | 字符串，如 "日程导出.csv" | 否 |

## 常见问题

### 1. 运行脚本时提示没有权限访问日历

首次运行脚本时，macOS 会弹出提示框询问是否允许终端访问您的日历。请点击"允许"以授权访问。如果您不小心点击了"不允许"，可以在系统偏好设置 > 安全性与隐私 > 隐私 > 日历中，勾选终端的权限。

### 2. 导出的 CSV 文件在 Excel 中显示乱码

脚本生成的 CSV 文件使用 UTF-8 编码。在 Excel 中打开时，请选择正确的编码方式。或者您可以使用 Numbers 应用程序打开，它能更好地支持 UTF-8 编码的 CSV 文件。

### 3. 导出的事件信息不完整

某些日历事件可能没有描述或地点信息，这是正常现象，取决于事件创建时是否填写了这些信息。

## 注意事项

- 此脚本仅适用于 macOS 系统，无法在 Windows 或 Linux 系统上运行
- 导出大量日程事件时可能需要一些时间，请耐心等待
- 建议定期备份您的日历数据，以防数据丢失

## 如何修改脚本

如果您需要自定义导出的字段或功能，可以直接编辑 `calendar_export.py` 文件。脚本中的主要函数包括：

- `run_applescript()`: 执行 AppleScript 脚本
- `get_all_calendars()`: 获取所有日历名称
- `export_calendar_events()`: 导出日历事件
- `save_to_csv()`: 将事件保存为 CSV 文件
- `main()`: 主函数，处理命令行参数并调用其他函数

## 更新日志

- v1.0: 初始版本，支持导出所有日历事件到 CSV 文件
